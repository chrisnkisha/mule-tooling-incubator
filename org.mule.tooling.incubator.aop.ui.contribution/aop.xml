<?xml version="1.0" encoding="UTF-8"?>

<namespace xmlns="http://www.mulesoft.org/schema/mule/tooling.attributes"
           xmlns:mule="http://www.mulesoft.org/schema/mule/core" prefix="aop"
           url="http://www.mulesoft.org/schema/mule/aop">
    <global-cloud-connector connectivityTesting="off"
                            extends="http://www.mulesoft.org/schema/mule/aop/abstractMule-aopConnectorGeneric"
                            abstract="true" image="" localId="parentConfig" icon="" description=""
                            caption="Mule AOP"></global-cloud-connector>
    <global-cloud-connector connectivityTesting="off"
                            extends="http://www.mulesoft.org/schema/mule/aop/parentConfig" abstract="false"
                            image="icons/large/mule-aop-connector-48x32.png" localId="config"
                            icon="icons/small/mule-aop-connector-24x16.png"
                            description="Global Mule AOP configuration information." caption="Mule AOP">
        <attribute-category description="Mule AOP configuration properties." caption="Pointcuts">
            <group caption="Generic" id="mule-aopGenericProperties">
                <name required="true"
                      description="Name of the configuration"
                      caption="Name" name="name"></name>
            </group>

            <childElement name="http://www.mulesoft.org/schema/mule/aop/pointcut"
                          inplace="true" caption="pointcut" allowMultiple="true" description="Pointcut configuration"/>
        </attribute-category>


        <attribute-category caption="Before Pointcut"
                            description="Define behaviour before running a message processor matched by a pointcut.">
            <childElement name="http://www.mulesoft.org/schema/mule/aop/before"
                          inplace="true" caption="Before Pointcut Action" allowMultiple="true"
                          description="Define which flow to run before executing a pointcut."/>
        </attribute-category>

        <attribute-category caption="After Pointcut"
                            description="Define behaviour after running a message processor matched by a pointcut.">
            <childElement name="http://www.mulesoft.org/schema/mule/aop/after"
                          inplace="true" caption="After Pointcut Action" allowMultiple="true"
                          description="Define which flow to run after executing a pointcut."/>
        </attribute-category>

        <attribute-category caption="After a Pointcut Failure"
                            description="Define behaviour after a failure of a message processor matched by a pointcut.">
            <childElement name="http://www.mulesoft.org/schema/mule/aop/after-fail"
                          inplace="true" caption="After Pointcut Failure Action" allowMultiple="true"
                          description="Define which flow to run after pointcut failure."/>
        </attribute-category>
    </global-cloud-connector>


    <nested caption="Message processor Matchers" localId="join"
            description="This defines the conditions under a message processor is evaluated to be affected by an aspect or not."
            extends="http://www.mulesoft.org/schema/mule/core/keyValueType"
            doNotInherit="key,value,value-ref">
        <string priority="-200" name="messageProcessor" required="true" description="The name of the message processor."
                caption="Message Processor"/>
        <childElement name="http://www.mulesoft.org/schema/mule/aop/attributes"
                      inplace="true" required="false" caption="Message processor attribute matcher" allowMultiple="false"
                      description="Expressions to be used to match a message processor by its attributes"/>

    </nested>

    <nested caption="Attributes" localId="attributes"
            description="Expressions to be used to match a message processor by its attributes"
            doNotInherit="key,value,value-ref">
        <childElement name="http://www.mulesoft.org/schema/mule/aop/attribute"
                      inplace="true" required="false" caption="Message processor attribute matcher" allowMultiple="true"
                      description="Expressions to be used to match a message processor by its attributes"/>

    </nested>

    <nested caption="Message processor attribute matchers" localId="attribute"
            description="Expressions to be used to match a message processor by its attributes"
            doNotInherit="key,value,value-ref">
        <string priority="-200" name="key" required="true" description="The attribute name"
                caption="Key"/>
        <string priority="-200" name="value" required="true" description="The attribute expression matcher"
                caption="Value"/>
    </nested>

    <nested caption="Pointcuts" localId="pointcut"
            description="A pointcut is a configuration element that defines points of the the mule app that we need to affect by an action."
            doNotInherit="key,value,value-ref">

        <name required="true"
              description="The name of the pointcut. This names is needed to define an action."
              caption="Name" name="name"></name>
        <childElement name="http://www.mulesoft.org/schema/mule/aop/join"
                      inplace="true" caption="Join Points Matcher" allowMultiple="true"
                      description="Points of the mule application that are affected by an action."/>
    </nested>

    <nested caption="Before Pointcut Actions" localId="before"
            description="Set of actions to be executed by pointcut."
            doNotInherit="key,value,value-ref">

        <name required="true"
              description="The name of the pointcut to be affected by the action."
              caption="Pointcut name" name="pointcut"></name>
        <flowRef required="true" name="run" caption="Run Flow"
                 description="Flow that is going to be run before the pointcut is executed." supportFlow="true"
                 removeEmptyOption="true"/>
    </nested>

    <nested caption="After Pointcut Actions" localId="after"
            description="Set of actions to be executed by pointcut."
            doNotInherit="key,value,value-ref">

        <name required="true"
              description="The name of the pointcut to be affected by the action."
              caption="Pointcut name" name="pointcut"></name>
        <flowRef required="true" name="run" caption="Run Flow"
                 description="Flow that is going to be run after the pointcut is executed." supportFlow="true"
                 removeEmptyOption="true"/>
    </nested>

    <nested caption="After Fail Actions" localId="after-fail"
            description="Set of actions to be executed by pointcut."
            doNotInherit="key,value,value-ref">

        <name required="true"
              description="The name of the pointcut to be affected by the action."
              caption="Pointcut name" name="pointcut"></name>
        <flowRef required="true" name="run" caption="Run Flow"
                 description="Flow that is going to be run after the pointcut fails." supportFlow="true"
                 removeEmptyOption="true"/>
    </nested>

    <cloud-connector abstract="true" category="org.mule.tooling.category.aop"
                     image="icons/large/mule-aop-connector-48x32.png" localId="abstractMule-aopConnectorGeneric"
                     icon="icons/small/mule-aop-connector-24x16.png" description="Interact with Mule-aop."
                     caption="Abstractmule-aopconnectorgeneric">
        <attribute-category description="General." caption="General">
            <group caption="Generic" id="abstractMule-aopConnectorGeneric">
                <globalRef requiredType="http://www.mulesoft.org/schema/mule/aop/config" required="true"
                           description="Specify which configuration to use for this invocation."
                           caption="Config Reference" name="config-ref"></globalRef>
            </group>
        </attribute-category>
    </cloud-connector>
    <cloud-connector extends="http://www.mulesoft.org/schema/mule/aop/abstractMule-aopConnectorGeneric"
                     category="org.mule.tooling.category.aop" image="icons/large/mule-aop-connector-48x32.png"
                     localId="mule-aop-connector" icon="icons/small/mule-aop-connector-24x16.png" description="
The before advice. Determines the behaviour after a pointcut fails
* ." caption="Mule AOP" aliasId="org.mule.tooling.ui.modules.core.pattern.mule-aop">
        <attribute-category description="General." caption="General">
            <group caption="Generic" id="mule-aopConnectorGeneric">
                <modeSwitch alwaysCombo="true" description="Operation." caption="Operation"
                            name="Mule-aop operations to execute"></modeSwitch>
            </group>
        </attribute-category>
    </cloud-connector>
</namespace>